import{s as t,c as s,w as e,i as o,o as l,a,b as n,t as c,I as i,d as u,e as r}from"./index-BrEnYvbw.js";const d=((t,s)=>{const e=t.__vccOpts||t;for(const[o,l]of s)e[o]=l;return e})({data:()=>({ngrokDomain:"ca77-219-128-230-37.ngrok-free.app",ws:null,env:{},wsStatus:"未连接",wsUrlCache:""}),onLoad(){this.connectWS()},onUnload(){this.closeWS()},methods:{connectWS(){if(this.ws&&(this.ws.close(),this.ws=null),!this.ngrokDomain)return void(this.wsStatus="请先输入后端域名");const t=`wss://${this.ngrokDomain}`;this.wsUrlCache=t;try{this.ws=new WebSocket(t),this.wsStatus="连接中...",this.ws.onopen=()=>{this.wsStatus="已连接",console.log("WebSocket已连接:",t)},this.ws.onmessage=t=>{try{this.env=JSON.parse(t.data)}catch{this.env={}}},this.ws.onerror=t=>{this.wsStatus="连接出错",console.log("WebSocket错误:",t)},this.ws.onclose=()=>{this.wsStatus="连接已关闭",console.log("WebSocket已关闭")}}catch(s){this.wsStatus="WebSocket连接异常",console.error("WebSocket异常:",s)}},changeNgrok(){this.connectWS(),t({title:"WebSocket已切换",icon:"none"})},closeWS(){this.ws&&(this.ws.close(),this.ws=null,this.wsStatus="已断开")},reconnectWS(){this.connectWS()}}},[["render",function(t,d,h,k,S,f){const w=i,g=u,_=o,p=r;return l(),s(_,{class:"container"},{default:e((()=>[a(_,{class:"block",style:{"margin-bottom":"20rpx"}},{default:e((()=>[a(w,{modelValue:S.ngrokDomain,"onUpdate:modelValue":d[0]||(d[0]=t=>S.ngrokDomain=t),placeholder:"请输入ngrok域名(如 ca77-219-128-230-37.ngrok-free.app)",class:"ngrok-input"},null,8,["modelValue"]),a(g,{onClick:f.changeNgrok},{default:e((()=>[n("切换WebSocket地址")])),_:1},8,["onClick"])])),_:1}),a(_,{class:"block"},{default:e((()=>[a(p,null,{default:e((()=>[n("🌡️ 温度："+c(S.env.temperature)+" ℃",1)])),_:1})])),_:1}),a(_,{class:"block"},{default:e((()=>[a(p,null,{default:e((()=>[n("💧 湿度："+c(S.env.humidity)+" %",1)])),_:1})])),_:1}),a(_,{class:"block"},{default:e((()=>[a(p,null,{default:e((()=>[n("🔆 光照："+c(S.env.light),1)])),_:1})])),_:1}),a(_,{class:"block"},{default:e((()=>[a(p,null,{default:e((()=>[n("📍 纬度："+c(S.env.latitude),1)])),_:1})])),_:1}),a(_,{class:"block"},{default:e((()=>[a(p,null,{default:e((()=>[n("📍 经度："+c(S.env.longitude),1)])),_:1})])),_:1}),a(_,{class:"block"},{default:e((()=>[a(p,null,{default:e((()=>[n("🛰️ 卫星数："+c(S.env.satellites),1)])),_:1})])),_:1}),a(_,{class:"status",style:{"margin-top":"30rpx"}},{default:e((()=>[a(p,null,{default:e((()=>[n("连接状态："+c(S.wsStatus),1)])),_:1})])),_:1}),a(g,{onClick:f.closeWS,type:"warn",style:{"margin-top":"20rpx"}},{default:e((()=>[n("断开WebSocket")])),_:1},8,["onClick"]),a(g,{onClick:f.reconnectWS,style:{"margin-top":"10rpx"}},{default:e((()=>[n("重新连接")])),_:1},8,["onClick"])])),_:1})}],["__scopeId","data-v-1a386857"]]);export{d as default};
